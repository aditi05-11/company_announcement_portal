<div class="container mt-5">
  <div class="card shadow-sm">
    <div class="card-body">
      <h5 class="card-title"><%= link_to @post.user.name, user_path(@post.user) %></h5>
      <% if @post.image.present? %>
        <div class="mb-3 text-center">
          <%= image_tag @post.image.url, class: "img-fluid rounded post-image" %>
        </div>
      <% end %>
      <p class="card-text"><%= @post.content %></p>
      <p class="card-text text-muted">Posted on: <%= @post.created_at.strftime('%B %d, %Y at %I:%M %p') %></p>
      <% if @post.user == current_user %>
        <%= link_to 'Edit Post', edit_post_path(@post), class: 'btn btn-outline-secondary mr-2' %>
      <% end %>
      <%= link_to 'Back to all posts', posts_path, class: 'btn btn-outline-primary' %>
    </div>
  </div>

  <h2 class="mt-4">Comments</h2>
  <%= render partial: 'comments/form', locals: { post: @post, comment: @comment } %>
  <%= render partial: 'comments/comments', locals: { comments: @comments, post: @post } %>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.addEventListener("click", (event) => {
      if (event.target.matches('[data-toggle="reply-form"]')) {
        event.preventDefault();
        const button = event.target;
        const commentId = button.getAttribute("data-comment-id");
        const replyForm = document.getElementById(`reply-form-${commentId}`);
        
        if (replyForm) {
          replyForm.style.display = (replyForm.style.display === "none" || replyForm.style.display === "") ? "block" : "none";
        }
      }
    });
  });
</script>

